---
# GPU Time-Slicing Configuration
# This ConfigMap configures the device plugin to allow time-slicing of GPUs
# allowing multiple pods to share a single GPU
apiVersion: v1
kind: ConfigMap
metadata:
  name: time-slicing-config
  namespace: gpu-operator
data:
  any: |-
    version: v1
    sharing:
      timeSlicing:
        replicas: 4
        resources:
        - name: nvidia.com/gpu
          replicas: 4
---
# Patch the ClusterPolicy to enable time-slicing
apiVersion: nvidia.com/v1
kind: ClusterPolicy
metadata:
  name: cluster-policy
spec:
  devicePlugin:
    config:
      name: time-slicing-config
      default: "any"
---
