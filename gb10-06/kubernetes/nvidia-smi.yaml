apiVersion: v1
kind: Pod
metadata:
  name: nvidia-smi
spec:
  runtimeClassName: nvidia
  restartPolicy: OnFailure
  containers:
      - name: nvidia-smi
        image: nvidia/cuda:13.0.2-runtime-ubuntu24.04
        command:
        - /bin/bash
        - -c
        - |
          echo "=========================================="
          echo "Pod: $HOSTNAME"
          echo "=========================================="
          nvidia-smi
          echo ""
          echo "Sleeping for 3600 seconds..."
          echo "Pod will stay alive to demonstrate GPU sharing"
          sleep 3600
        resources:
          limits:
            nvidia.com/gpu: 1
          requests:
            nvidia.com/gpu: 1
        env:
        - name: NVIDIA_VISIBLE_DEVICES
          value: "all"
        - name: NVIDIA_DRIVER_CAPABILITIES
          value: "compute,utility"